 Open Firm Accounting - TODO

 Summary
 =======

   TODO
   DONE

-----------------------------------------------------------------------
 TODO
 ====

   1 2014- 5- 2 have a dns domain for the application
                (e.g. open-freelance-accounting.org)

   3 2014- 5- 2 ofa.doap: have a download page

   5 2014- 5- 2 ofa.doap: have a mailing list

   7 2014- 5- 2 have a preference to set the application menu on the
                top bar (gnome-shell) or on the main windows

  41 2014- 5-12 ofaMainWindow: set menu tooltips

  43 2014- 5-12 ofaMainWindow left pane: should display a big icon and
                a label instead of only a text

  49 2014- 5-15 All properties: monitor "notes" size so
                that we stop the entering at 512 chars
     2014- 6-21 at 4096 chars now...
     2015-10- 6 monitoring works and doesn't allow more than 4095 chars
                but keep emitting a Gtk-Warning

  85 2014- 5-21 Color the frame of the invalid GtkEntry
                + set data "ofa-data-entry-valid"
                + my_utils_entry_is_valid
                + my_utils_entry_set_valid
     2014- 5-22 see also (cancelled) todo #20

 126 2014- 5-28 have several demo dossiers

 152 2014- 6- 3 import qif files

 153 2014- 6- 3 import ofx/ofc files

 215 2014- 6-13 assets management
     2014- 6-16 to be built as a plugin

 217 2014- 6-13 tableau de trésorerie
     2014-10- 6 this may require the balance be printed
     2014-10- 6 this should be implemented as a plugin

 253 2014- 6-24 editing rough entries: have a 'select' button besides 
                of the account number when editing an entry

 254 2014- 6-24 editing rough entries: have a 'select' button besides
                of the ledger mnemo when editing an entry

 255 2014- 6-23 editing rough entries: add a button to revert the 
                modifications
 
 256 2014- 6-23 editing rough entries: add an icon to advertise that 
                the row has been modified
     2015- 2- 5 the entry is saved as soon as the edition finishes
                so there would be an added value if and only if we
                would have a modification history and would be capable
                of going back...

 259 2014- 6-23 editing rough entries: copy/paste a line

 273 2014- 6-29 ofa.css: hack ofaTabLabel/GtkGrid/GtkButton/GtkImage 
                styles

 312 2014- 9-22 myEditableAmount: should limit the count of decimals

 313 2014- 9-22 myEditableAmount: should have a format string to
                display a 'decoration' when rendering (e.g. a unit, or
                a standard prefix, or a display format)

 314 2014- 9-26 have a preference to use millenary shortcut
                (i.e. entering '14' gives '2014')

 334 2014-10-18 homogeneize styles:
                e.g. displaying validated entries in ofaViewEntries or
                validated balances if AccountProperties should have the
                same font/background
                + may be useful to use styles ?

 445 2014-11-13 my_date: do not accept two successive '/'
     2014-11-23 done - svn #4145
     2015- 1- 8 opened back as doesn't work

 461 2014-11-24 ExportAssistant: implement 'on_new_profile'
     2017- 4-12 id. on import assistant

 462 2014-11-26 move ofoBat/ofoBatLine to ofaBoxed
     2015- 1- 5 really only required when ofoBat/ofoBatLine will implement
                the ofaIExportable interface - so it is not urgent
     2017- 4- 5 ofoBat uses ofaBox, and is exportable

 525 2014-12-13 when importing entries: review the code to be faster
                import accounts: 0.02286 s/row - 0.02316 s/row (127 rows)
                import ledgers:  0.02982 s/row (9 rows)
                import entries:  0.13268 s/row (2431 rows)
                import entries:  0.13237 s/row (1985 rows)
     2015- 1- 9 problem is the same when closing ledgers
     2015- 1-10 idem when validating entries:
                count=484: average is 0.09846 s

 559 2015- 1- 8 have a macro language to automate dossier creation,
                import of files
     2016- 1-27 other use case: automatically print the reports on
                period closing

 584 2015- 1-12 ofo_insert_entry: should also insert reconciliation and
                settlement data groups if they are set in the object
                (would prevent two updates when closing the exercice)

 632 2015- 2- 8 desktop file: use prefix when installing icon elsewhere
                than standard prefix=/usr
     2016- 1-25 icon is installed in $(datadir)

 652 2015- 2-15 let the user configure colors
     2015- 3-13 (branch colors) doesn't know how to go back from custom 
                in GtkColorChooserWidget (this is bad)
                + have to decide whether dossier color is a user pref
                or a dossier pref (for all users of this dossier)

 656 2015- 2-17 OpeTemplate page: have a shortcut on each tab

 684 2015- 2-21 MainWindow left pane: these are shortcuts which should
                be choosable by the user among the defined features

 706 2015- 3- 9 be able to configure some user shortcuts (in particular,
                it would be easier that row-activate on templates page
                opens the guided input rather that the properties)

 809 2015- 4-17 FEAT when computing the ODs, do not generate an OD for
                     "forfait kilométrique BNC" when option is "FR"

 810 2015- 4-17 FEAT when computing the ODs, the "Frais réels du
                     véhicule" should distinguish HT and TVA (but, yes,
                     compute on TTC)

 812 2015- 4-17 FEAT libellé des écritures d'amortissement: ajouter le
                     numéro d'annuité et le nb total (#7 - 3/4)

 821 2015- 4-27 ARCH check that concenating strings doesn't override the
                     limit (as the MySQL truncation may make the string
                     invalid utf-8) and take care to truncate to a valid
                     utf-8

 824 2015- 9-22 PACK use AX_COMPILER_FLAGS

 825 2015- 9-22 PACK use AM_GNU_GETTEXT instead of AM_GLIB_GNU_GETTEXT

 862 2015-10- 7 DISP fix focus order on GtkBin-derived widgets on the
                     assistants
                     - RestoreAssistant: dossier treeview after created
                       a new dossier
                     - administrative credentials

 910 2015-11-30 FEAT let the user configure the main title components as
                     a preference

 938 2015-12-21 ARCH distinguish a core api with core objects (eg. for
                     command-line only tools) and a ui api which contains
                     some base classes and interfaces which would be useful
                     for plugins => implies to have a core lib and a ui lib
     2015-12-27      have to choose between api/ui or api-ui styles

 966 2016- 1-10 FEAT tva/ofoTVARecord: make it printable
     2016- 6- 3  with a checkbutton for printing all lines including zeroes,
                 or only non-zero lines

 971 2016- 2- 3 FEAT have recently used dossiers
     2016- 3-23 note that this list should go to dossier settings

 983 2016- 2-11 FEAT ImportAssistant: each type should be able to add its
                     own GtkBin, in order to take its own parameters
                     use case: when importing entries, should be able to
                     choose whether to import reconciliations/settlements
                     or no, to import deleted entries
     2016- 3- 1 +accounts: import balances
     201è- 2- 7 it would be more useful to have a preview of the imported
                file, and a mapping page

1003 2016- 2-24 FEAT RenderPage: add navigation+zoom buttons

1012 2016- 2-25 FEAT OpeTemplate: when a row is moved up or down, then
                     the indexes should be updated accordingly

1075 2016- 4-14 have a message bar
     2016- 4-20 describe a use case

1093 2016- 4-19 CODE should ICollector have its own messaging system
                     on add/remove actions (update/reload cannot be managed
                     here) ?
     2016- 5- 2 use case: maintain the misc-collector UI up to date

1102 2016- 5- 1 my_utils_widget_style_xx: is not consistent with a CSS
                file in the application directory layout

1153 2016- 6-22 FEAT: besides of the integrity constraint checks, display
                e.g. operation templates which use such account, and so on

1235 2016-10-12 begining of the exercice cannot be modified anymore after
                the first exercice operation
     2017- 3-29 unless entries are rightly remediated
     2017- 4-10 which is the eventually the case
                + is the beginning of the exercice relative to a period
                closing or to a ledger closing ?

1236 2016-10-13 DBMS: move user and dossier settings to dbms
     2016-11-13 dossier settings are:
                $ grep -vE '^#|^\[|^ofa-DBMSProvider|^mysql-db-' ~/.config/openbook/dossier* | cut -d: -f2- | cut -d= -f1 | sort -u
                - LastBackupFolder
                - ofa-BackgroundImage
                - ofa-LastBackupFolder
                - ofa-LastExportFolder
                - ofa-LastImportFolder
                - ofa-OpeTemplateBookOrder
                - ofa-UserPreferences-settings
                - OpeTemplateBookOrder
     2016-12-18 note that updating dossier settings triggers a reload
                of dossier_collection (due to file monitoring)
     2017- 2- 6 we also need an ofaIDBConnect opened connection on the dossier

1243 2016-10-22 have a command-line tool which displays the version of
                each of the DBModels of a saved database

1255 2016-11-13 have a setting per dossier to automatize backups path and name
     2016-11-17 path is nonetheless kept from last function call
                so only name has to be configurable

1260 2016-11-17 ebp2013 reprise is empty (no entries nor ledger)
                => have recovery assistant
     2017- 2- 1 TODO: insert entry in a non-opened dossier...
     2017- 2- 5 main issue is that allocated entry numbers will most
                probably overlap the numbers of the current exercice;
                this would be bad; the most obvious solution would be
                to have only one dossier table for all known exercices. 

1261 2016-11-17 Have a backup option to save all available periods
                + have an option to save this choice (do not automatically save)

1263 2016-11-19 DBMS: store documents
                + attach documents via an interface to:
                - BAT: the original imported document from the bank,
                - operations: the bill, or the purchase trace
                - entries: idem operation,
                - accounts: all documents for this account
     2017- 2- 6 dbms is prepared
     2017- 3-16 do not omit to check for deletability of all objects
                which might have a document

1344 2017- 2- 3 re-authorize dossier open from command-line

1351 2017- 2- 9 Review export and import formats, especially the tables
                with children and companions (e.g. entries+concil, or
                accounts+archived_balances)
                + have a version number
     2017- 4-12 review standard class export format

1379 2017- 3- 9 UI: VatForm: set template column to fixed width, rather expand label

1396 2017- 3-16 check conciliation groups integrity is wrong
                - display erroneous orphan conciliation member with BatLineId xxx
                - count is wrong
                + anyway, this cannot be really done while the exercice has
                not been rightly archived

1402 2017- 3-17 when generating the ODs for non-deductible CSG, should
                also generate an OD for deductible CSG to 629 account 

1417 2017- 3-24 ope_template: have a tiers id field depending of the template
     2017- 3-25 dbms is updated

1418 2017- 3-24 ope template has a prof. share (quote-part pro)
     2017- 3-25 dbms is updated

1445 2017- 4-10 check integrity: check char(1) columns
                eg. entry status, rule, period

1451 2017- 4-10 assistants are not transient vs. the main window ?
                (at least a second icon appears in the gnome status bar)
     2017- 4-11 nor are the nomodal pages, nor the mydndwindows

1455 2017- 4-12 when importing the default accounts chart on new dossier:
                review the source file (does not fit the new table format)
     2017-11-11 idem for all imported files

1466 2017- 4-18 reconciliation page: have a pane in the status bar so
                that the user can roughly align amounts with the treeview
                (idem entry page)
     2017- 5- 3 difficult as 1/ footer is aligned with header,
                and 2/ expands on two lines

1474 2017- 8-10 since Gtk 3.22 (F26), windows size and position are no
                more restored (probably a Wayland/Mutter issue as X works
                well)

1477 2017- 8-15 icontext: better position the context menu, depending of
                activated from the keyboard or by mouse

1489 2017-10-14 review period closing to actually forbid entries only
                during period close - so will able to close N+1/01,
                N+1/02, etc. even if exercice N is not yet closed
     2017-12-21 this may be complex as closing a period implies to archive
                the accounts balances, while leaving an period opened leads
                to accept new entries (which modify these same balances)

1491 2017-10-19 guided input: the ref field may be a combobox with an
                input field

1492 2017-10-19 have a nodejs server with a REST API:
                - calculate VAT

1495 2017-10-19 BUG when updating the amount of an entry for the second time
                (openbook:12473): OFA-DEBUG: ofa_idbconnect_query: connect=0x104b480, query='UPDATE OFA_T_ENTRIES 	SET ENT_DEFFECT='2017-09-05',ENT_DOPE='2017-09-05',ENT_LABEL='Caisse RSI des prof. libérales', ENT_REF='PREL',	ENT_ACCOUNT='51241',ENT_CURRENCY='EUR',ENT_LEDGER='ACH', ENT_OPE_TEMPLATE='CSRSI',ENT_RULE='N',ENT_TIERS=NULL,ENT_IPERIOD='C',ENT_NOTES=NULL,	ENT_DEBIT=0,ENT_CREDIT=227.00,ENT_UPD_USER='wieser',ENT_UPD_STAMP='2017-10-19 22:33:57' 	WHERE ENT_NUMBER=8764', display_error=True
                (openbook:12473): OFA-DEBUG: ofo_dossier_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_account_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_ledger_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_ope_template_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_entry_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_account_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_recurrent_run_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_recurrent_model_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_tva_record_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofo_tva_form_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), empty=(nil)
                (openbook:12473): OFA-DEBUG: ofa_reconcil_store_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), self=0x1c6f740
                (openbook:12473): OFA-DEBUG: ofa_reconcil_store_signaler_on_updated_base: signaler=0x9fe8e0, object=0x3260160 (ofoEntry), prev_id=(null), self=0x1c6f5a0
                Thread 1 "openbook" received signal SIGSEGV, Segmentation fault.
                0x00007ffff7a4408b in ofa_amount_to_str (amount=227, currency=0xd41ee0, getter=0x9fe8e0) at ../../../src/core/ofa-amount.c:138
                138		digits = currency && OFO_IS_CURRENCY( currency ) ?
                #0  0x00007ffff7a4408b in ofa_amount_to_str (amount=227, currency=0xd41ee0, getter=0x9fe8e0) at ../../../src/core/ofa-amount.c:138
                #1  0x00007ffff7aaec3d in entry_get_amount_strs (self=self@entry=0x1c6f5a0, entry=entry@entry=0x3260160, sdebit=sdebit@entry=0x7fffffffb700, scredit=scredit@entry=0x7fffffffb708)
                    at ../../../src/core/ofa-reconcil-store.c:499
                #2  0x00007ffff7aaedfc in entry_set_row_by_iter (self=self@entry=0x1c6f5a0, entry=entry@entry=0x3260160, iter=iter@entry=0x7fffffffb750) at ../../../src/core/ofa-reconcil-store.c:400
                #3  0x00007ffff7ab03de in signaler_on_updated_entry (entry=0x3260160, self=0x1c6f5a0) at ../../../src/core/ofa-reconcil-store.c:1415
                #4  0x00007ffff7ab03de in signaler_on_updated_base (signaler=<optimized out>, object=<optimized out>, prev_id=<optimized out>, self=0x1c6f5a0) at ../../../src/core/ofa-reconcil-store.c:1400

1500 2017-10-22 DBMS AUDIT: add current user

1502 2017-11- 2 DBMS RecurrentModel: move editable amounts to a child table

1503 2017-11- 2 DBMS RecurrentRun: move amounts to a child table

1517 2017-11-17 DBMS: have user+timestamp on entry status change

1518 2017-11-17 when deleting an entry:
                UPDATE OFA_T_ENTRIES SET ENT_IPERIOD='C',ENT_STATUS='D' WHERE ENT_NUMBER=5568
                why the iperiod has to be updated (does not supposed to be modified
                on a status change)

1519 2017-11-17 VAT: when accounting operations are deleted, the corresponded
                detail lines should be updated (set to null) accordingly

1521 2017-11-17 VAT: after operation has been generated, computing is forbidden
                and properties are no more modifiable

1522 2017-11-17 VAT: should monitor ofa_t_entries status change, so that delete
                the operation if entries are deleted, or validate the record if
                entries are validated
                -> what happens during period closing ?

1524 2018- 1-19 Macro in entries label are not expanded on all entries
                of an operation (cf. for example 'reversement de tva'

1525 2018- 1-19 when re-entering a new operation on the same template than
                previous, and entering a new amount in first line, second
                and third VAT lines rightly recompute, but not fourth. Why ?

1526 2018- 1-19 BUG: when reconciliating a line
     2018- 2-25 cannot reproduce

1527 2018- 1-19 BUG: on reconciliation, open the select BAT window and escape
                without selectionning any line
     2018- 2-25 cannot reproduce

1530 2018- 2-17 Segfault when updating an amount in view entries while the
                reconciliation is opened
     2018- 2-22 cannot reproduce

1534 2018- 3-11 BUG when importing ODs
                (openbook:23243): OFA-DEBUG: ofa_importer_csv_get_lines_from_content: splitted count=51
(openbook:23243): OFA-DEBUG: ofo_entry_init: instance=0x7fffc8018520 (ofoEntry)
#3  0x00007ffff7af619c in ofs_currency_add_by_object (list=list@entry=0x7fffffffd8b0, currency=currency@entry=0x0, debit=debit@entry=0, credit=0)
    at ../../../src/core/ofs-currency.c:77
#4  0x00007ffff7ade0f5 in iimportable_import_parse (lines=<optimized out>, parms=0x7fffffffd9c0, importer=0x91b850) at ../../../src/core/ofo-entry.c:4059
(openbook:23243): OFA-CRITICAL **: entry_compute_status: assertion 'my_date_is_valid( deffect )' failed

1535

-----------------------------------------------------------------------
 DONE
 ====

1528 2018- 2-17 BUG: reconciliation page: 'clear' button appears disabled
     2018- 2-25 fixed

1529 2018- 2-17 BUG: when importing LCL BAT PDF, where is taken effect year from ?
                (should be the same that value year, or at least from begin date)
     2018- 2-22 fixed

1531 2018- 2-22 review user/timestamp display when null
     2018- 2-23 done

1532 2018- 2-25 Recurrent: unselect all when defining new
     2018- 2-28 done

1533 2018- 3- 6 should be able to export v1 accounts to be reimported when
                pre-ods and post-ods charts - most probably should define
                a specific exporter
     2018- 3-10 done

-----------------------------------------------------------------------
 P. Wieser - Created on 2014, may 2nd
             Last updated on 2018, feb. 22nd.
